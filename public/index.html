<html>
    <head>
        <meta charset="utf-8" />
        <title>Meu Primeiro Jogo Multiplayer</title>

        <style>
            #screen {
                border: 10px solid #ccc;
                background-color: black;
                image-rendering: pixelated;
                image-rendering: crisp-edges;
                image-rendering: -moz-crisp-edges;
                width: 630;
                height: 630;
                position: absolute;
                left: 25%;
                display: block;
            }

            #scoreboard {
                width: 100px;
                height: 50px;
            }

            #demo {
                border: 1px solid black;
                border-radius:10px;
                text-align: center;
                font-size: 50px;
                font-weight: bold;
            }

        </style>
        <script src="/socket.io/socket.io.js"></script>
    </head>
    <body>
        <canvas id="screen" width="500" height="500"></canvas>

        <div id="scoreboard">
            <p id="demo">0:0</p>
        </div>

        <script type="module">
            import renderScreen from './render-screen.js'
            
            
            const socket = io()

            socket.on('connect', () => {
                const playerId = socket.id
                console.log(`>Player connected on Client with id: ${playerId}`)
                const screen = document.getElementById('screen')
            })

            socket.on('setup', (state) => {
                const gameState = state
                renderScreen(screen, gameState, requestAnimationFrame)
            })

            socket.on('player', (playersConnected) => {
                const playersConnected = playersConnected
            })

            socket.on('move', (state) => {
                gameState = state
            })

            addEventListener('keydown', () => {
                const keydown = event.key
                const command = {
                    playerId: socket.id,
                    keydown
                }
                socket.emit('keyPressed', command)
            })

        </script>
    </body>
</html>